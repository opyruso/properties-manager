cd /opt
mkdir props
mkdir props/props-dev
mkdir props/props-rec
mkdir props/props-pro
mkdir props/props-api-dev
mkdir props/props-api-rec
mkdir props/props-api-pro
chmod -R 777 props
chown -R opyruso:opyruso props

# as root
mkdir /opt/actions-runner-props
cd /opt/actions-runner-props
curl -o actions-runner-linux-x64-2.328.0.tar.gz -L https://github.com/actions/runner/releases/download/v2.328.0/actions-runner-linux-x64-2.328.0.tar.gz
tar xzf ./actions-runner-linux-x64-2.328.0.tar.gz
chwon -R opyruso:opyruso /opt/actions-runner-props
su opyruso
./config.sh --url https://github.com/opyruso/oPyRuSo-Public-Website --token AE6RTM2PY4X2CIG62AKVKLLIU355I
exit
./svc.sh install
./svc.sh start








vi props-api-dev/serviceinstaller.sh

#!/bin/bash

# Variables
SERVICE_NAME="quarkus-props-api-dev"
BOT_USER="props-api-dev"
BOT_DIR="/opt/props/$BOT_USER"
JAR_NAME="props-api-runner.jar"
SERVICE_FILE="/etc/systemd/system/$SERVICE_NAME.service"

echo "?? Création de l'utilisateur système '$BOT_USER' (sans shell ni home)..."
id "$BOT_USER" &>/dev/null || useradd -r -s /sbin/nologin "$BOT_USER"

echo "?? Création du dossier $BOT_DIR..."
mkdir -p "$BOT_DIR"
chown "$BOT_USER":"$BOT_USER" "$BOT_DIR"

echo "?? Copie du JAR dans $BOT_DIR..."
cp "$JAR_NAME" "$BOT_DIR/"
chown "$BOT_USER":"$BOT_USER" "$BOT_DIR/$JAR_NAME"

echo "?? Création du service systemd..."
cat > "$SERVICE_FILE" <<EOF
[Unit]
Description=$SERVICE_NAME
After=network.target

[Service]
User=$BOT_USER
WorkingDirectory=$BOT_DIR
ExecStart=/usr/bin/java -jar $BOT_DIR/$JAR_NAME
SuccessExitStatus=143
Restart=on-failure
RestartSec=5

[Install]
WantedBy=multi-user.target
EOF

echo "?? Reload systemd & enable service..."
systemctl daemon-reexec
systemctl daemon-reload
systemctl enable "$SERVICE_NAME"
systemctl start "$SERVICE_NAME"

echo "? Service $SERVICE_NAME installé et démarré."
systemctl status "$SERVICE_NAME" --no-pager












vi props-api-rec/serviceinstaller.sh

#!/bin/bash

# Variables
SERVICE_NAME="quarkus-props-api-rec"
BOT_USER="props-api-rec"
BOT_DIR="/opt/props/$BOT_USER"
JAR_NAME="props-api-runner.jar"
SERVICE_FILE="/etc/systemd/system/$SERVICE_NAME.service"

echo "?? Création de l'utilisateur système '$BOT_USER' (sans shell ni home)..."
id "$BOT_USER" &>/dev/null || useradd -r -s /sbin/nologin "$BOT_USER"

echo "?? Création du dossier $BOT_DIR..."
mkdir -p "$BOT_DIR"
chown "$BOT_USER":"$BOT_USER" "$BOT_DIR"

echo "?? Copie du JAR dans $BOT_DIR..."
cp "$JAR_NAME" "$BOT_DIR/"
chown "$BOT_USER":"$BOT_USER" "$BOT_DIR/$JAR_NAME"

echo "?? Création du service systemd..."
cat > "$SERVICE_FILE" <<EOF
[Unit]
Description=$SERVICE_NAME
After=network.target

[Service]
User=$BOT_USER
WorkingDirectory=$BOT_DIR
ExecStart=/usr/bin/java -jar $BOT_DIR/$JAR_NAME
SuccessExitStatus=143
Restart=on-failure
RestartSec=5

[Install]
WantedBy=multi-user.target
EOF

echo "?? Reload systemd & enable service..."
systemctl daemon-reexec
systemctl daemon-reload
systemctl enable "$SERVICE_NAME"
systemctl start "$SERVICE_NAME"

echo "? Service $SERVICE_NAME installé et démarré."
systemctl status "$SERVICE_NAME" --no-pager












vi props-api-pro/serviceinstaller.sh

#!/bin/bash

# Variables
SERVICE_NAME="quarkus-props-api-pro"
BOT_USER="props-api-pro"
BOT_DIR="/opt/props/$BOT_USER"
JAR_NAME="props-api-runner.jar"
SERVICE_FILE="/etc/systemd/system/$SERVICE_NAME.service"

echo "?? Création de l'utilisateur système '$BOT_USER' (sans shell ni home)..."
id "$BOT_USER" &>/dev/null || useradd -r -s /sbin/nologin "$BOT_USER"

echo "?? Création du dossier $BOT_DIR..."
mkdir -p "$BOT_DIR"
chown "$BOT_USER":"$BOT_USER" "$BOT_DIR"

echo "?? Copie du JAR dans $BOT_DIR..."
cp "$JAR_NAME" "$BOT_DIR/"
chown "$BOT_USER":"$BOT_USER" "$BOT_DIR/$JAR_NAME"

echo "?? Création du service systemd..."
cat > "$SERVICE_FILE" <<EOF
[Unit]
Description=$SERVICE_NAME
After=network.target

[Service]
User=$BOT_USER
WorkingDirectory=$BOT_DIR
ExecStart=/usr/bin/java -jar $BOT_DIR/$JAR_NAME
SuccessExitStatus=143
Restart=on-failure
RestartSec=5

[Install]
WantedBy=multi-user.target
EOF

echo "?? Reload systemd & enable service..."
systemctl daemon-reexec
systemctl daemon-reload
systemctl enable "$SERVICE_NAME"
systemctl start "$SERVICE_NAME"

echo "? Service $SERVICE_NAME installé et démarré."
systemctl status "$SERVICE_NAME" --no-pager










chmod +x props-api-dev/serviceinstaller.sh
chmod +x props-api-rec/serviceinstaller.sh
chmod +x props-api-pro/serviceinstaller.sh






vi props-api-dev/config/application.properties
vi props-api-rec/config/application.properties
vi props-api-pro/config/application.properties

chown -R opyruso:opyruso props-api-dev/config
chown -R opyruso:opyruso props-api-rec/config
chown -R opyruso:opyruso props-api-pro/config


DATABASE (cf script)

